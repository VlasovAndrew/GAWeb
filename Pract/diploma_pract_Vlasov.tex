\documentclass[bachelor, och, pract, times]{SCWorks}
% параметр - тип обучения - одно из значений:
%    spec     - специальность
%    bachelor - бакалавриат (по умолчанию)
%    master   - магистратура
% параметр - форма обучения - одно из значений:
%    och   - очное (по умолчанию)
%    zaoch - заочное
% параметр - тип работы - одно из значений:
%    referat    - реферат
%    coursework - курсовая работа (по умолчанию)
%    diploma    - дипломная работа
%    pract      - отчет по практике
%    pract      - отчет о научно-исследовательской работе
%    autoref    - автореферат выпускной работы
%    assignment - задание на выпускную квалификационную работу
%    review     - отзыв руководителя
%    critique   - рецензия на выпускную работу
% параметр - включение шрифта
%    times    - включение шрифта Times New Roman (если установлен)
%               по умолчанию выключен
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage{graphicx}

\usepackage[sort,compress]{cite}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyvrb}
\usepackage{longtable}
\usepackage{array}
\usepackage[english,russian]{babel}


\usepackage[colorlinks=true]{hyperref}


\newcommand{\eqdef}{\stackrel {\rm def}{=}}

\newtheorem{lem}{Лемма}

\begin{document}

% Кафедра (в родительном падеже)
\chair{математической кибернетики и компьютерных наук}

% Тема работы
\title{Создание приложения для анализа генетического алгоритма поиска центральных вершин}

% Курс
\course{4}

% Группа
\group{411}

% Факультет (в родительном падеже) (по умолчанию "факультета КНиИТ")
%\department{факультета КНиИТ}

% Специальность/направление код - наименование
\napravlenie{02.03.02 "--- Фундаментальная информатика и информационные технологии}

% Фамилия, имя, отчество в родительном падеже
\author{Власова Андрея Александровича}

% Заведующий кафедрой
\chtitle{к.\,ф.-м.\,н.} % степень, звание
\chname{С.\,В.\,Миронов}

%Научный руководитель (для реферата преподаватель проверяющий работу)
\satitle{к.\,ф.-м.\,н.} %должность, степень, звание
\saname{С.\,В.\,Миронов}

% Руководитель практики от организации (только для практики,
% для остальных типов работ не используется)
\patitle{к.\,ф.-м.\,н.}
\paname{С.\,В.\,Миронов}

% Семестр (только для практики, для остальных
% типов работ не используется)
\term{2}

% Наименование практики (только для практики, для остальных
% типов работ не используется)
\practtype{учебная}

% Продолжительность практики (количество недель) (только для практики,
% для остальных типов работ не используется)
\duration{2}

% Даты начала и окончания практики (только для практики, для остальных
% типов работ не используется)
\practStart{01.07.2020}
\practFinish{14.07.2020}

% Год выполнения отчета
\date{2020}

\maketitle

% Включение нумерации рисунков, формул и таблиц по разделам
% (по умолчанию - нумерация сквозная)
% (допускается оба вида нумерации)
%\secNumbering

\tableofcontents

% Раздел "Обозначения и сокращения". Может отсутствовать в работе

% Раздел "Введение"
\intro


adasdasd
\section{Использование приложения}

\section{Описание технологий и архитектуры приложения}
В качестве языка программирования для решения поставленной задачи был выбран объектно"=ориентированный язык C\#.
Вместе с тем для создания клиент"=серверного приложения был использован фреймворк \verb|ASP.NET MVC 5|, который позволяет 
создавать веб-приложения с использованием архитектуры \verb|MVC|. Кроме этого в качестве системы объектно"=реляционного 
отображения используется технология \verb|Entity Framework 6|. При этом приложение разделено на три слоя абстракции --- уровень 
доступа к данным, уровень бизнес"=логики и уровень визуального представления. 

\subsection{Структура базы данных}
Хранение графов в базе данных были созданы следующие таблицы: \verb|Graphs| и \verb|Edges|. 
При этом таблица \verb|Graphs| содержит следующие поля:
\begin{itemize}
    \item поле \verb|Id| (типа данных \verb|INT|) "--- уникальный идентификатор, внутренний ключ,
    \item поле \verb|N| (типа данных \verb|INT|) "--- количество вершин в графе, 
    \item поле \verb|M| (типа данных \verb|INT|) "--- количество ребер в графе,
    \item поле \verb|Name| (типа данных \verb|NVARCHAR|) "--- название графа,
    \item поле \verb|R| (типа данных \verb|INT|) "--- радиус графа.
\end{itemize}
Кроме этого таблица \verb|Edges| состоит из следующих полей: 
\begin{itemize}
    \item поле \verb|Id| (типа данных \verb|INT|) "--- уникальный идентификатор, внутренний ключ,
    \item поле \verb|V1| (типа данных \verb|INT|) "--- одна из вершин, которые соединяет ребро, 
    \item поле \verb|V1| (типа данных \verb|INT|) "--- вторая из вершин, которые соединяет ребро,
    \item поле \verb|Graph_Id| (типа данных \verb|INT|) "--- \verb|Id| графа, которому принадлежит ребро, внешний ключ.
\end{itemize}
Кроме этого для хранения зарегестрированных пользователей существует таблица \verb|Users|:
\begin{itemize}
    \item поле \verb|Id| (типа данных \verb|INT|) "--- уникальный идентификатор, внутренний ключ,
    \item поле \verb|Login| (типа данных \verb|NVARCHAR|) "--- логин пользователя,
    \item поле \verb|Password| (типа данных \verb|NVARCHAR|) "--- зашифрованный пароль пользователя.
\end{itemize}

Полная диаграмма таблиц представлена на рисунке \ref{fig:f1}:
\begin{figure}[!ht]
	\centering
	\includegraphics{pic/database_diagram.png}
	\caption{\label{fig:f1}	Диаграмма базы данных}
\end{figure}

Для создания базы данных используется технология \verb|Entity Framework|, вместе с чем использовался подход 
\verb|Code-first|, согласно которому были созданы классы \verb|Graph|, \verb|GraphInfo|, \verb|Edge|, \verb|User|, описывающие 
модели данных:
\begin{Verbatim}[fontsize=\small, numbers=left]
public class GraphInfo 
{
	public int Id { get; set; }
	public int N { get; set; }
	public int M { get; set; }
	public string Name { get; set; }
	public int R { get; set; }
}
\end{Verbatim}

\begin{Verbatim}[fontsize=\small, numbers=left]
public class Graph : GraphInfo 
{
	public ICollection<Edge> Edges { get; set; }
	public Graph()
	{
		Edges = new List<Edge>();
	}
}
\end{Verbatim}

\begin{Verbatim}[fontsize=\small, numbers=left]
public class Edge 
{
	public int Id { get; set; }
	public int V1 { get; set; }
	public int V2 { get; set; }
}
\end{Verbatim}

\subsection{Уровень доступа к данным}
Для гибкой и стандартизированной работы с базой данных был создан ряд интерфейсов,
в которые были вынесены основные методы для доступа к данным и их изменениям.
Классы, реализующие эти интерфейсы представляют собой уровень доступа к данным, при этом 
использование интерфейсов позволяет с легкостью изменять реализацию этих классов, а также упрощает 
процесс тестирования.

Далее приводится код основных интерфейсов, которые используются при работе с данными:
\begin{Verbatim}[fontsize=\small, numbers=left]
public interface IGraphDao
{
        IEnumerable<GraphInfo> GetAllGraphInfo();
        Graph GetById(int id);
        Graph Add(Graph graph);
}
\end{Verbatim}
  
\begin{Verbatim}[fontsize=\small, numbers=left]
public interface IUserDao
{
        User GetById(int id);
        User GetByName(string name);
        User Add(User user);
}
\end{Verbatim}

Вместе с тем для использования технологии \verb|Entity Framework| созданы классы \verb|GraphContext| и \verb|UserContext|, 
которые наследуются от класса \verb|System.Data.Entity.DbContext|, что позволяет получить возможность для легкого
доступа к базе данных без написания SQL запросов. Классы \verb|GraphContext| и \verb|UserContext| содержат в себе поля типа
\verb|DbSet<Graph>| и \verb|DbSet<User>|, через которые происходит добавление, чтение или изменение данных в базе данных.
Кроме этого в этих классах описан статический конструктор, внутри которого указан способ начальной инициализации базы данных, 
за счет классов \verb|UserContextInitializer| и \verb|GraphContextInitializer|. Эти классы наследуются от класса 
\verb|CreateDatabaseIfNotExists|, что позволяет фреймворку выполнить начальное заполнение данными, если база данных еще не 
существует, за счет кода, который описан в переопределенном методе \verb|Seed|. 
Внутри этого метода происходит чтение нескольких созданных графов из текстовых файлов, 
все это происходит внутри метода, описанного в классе \verb|GraphContextInitializer|, в этом же методе в классе 
\verb|UserContextInitializer| добавляется пользователь с логином \verb|admin| и паролем \verb|admin|. Полный код представлен в 
приложении [ссылка].
 
\subsection{Уровень бизнес-логики}
Уровень бизнес-логики представляет собой похожую структуру, как и уровень доступа данных "--- так же 
созданы ряд интерфейсов и классы, которые их реализуют. 
При этом многие из этих интерфейсов похожи на те, которые описаны в уровне доступа к данным, однако 
именно на этом уровне происходит запуск генетического алгоритма с различными параметрами и    
анализ загруженных графов.
С определением интерфейсов и классов реализующих бизнес-логику приложения можно ознакомиться в приложении [ссылка].
Классы \verb|GraphBL| и \verb|UserBL|, реализуют интерфейсы \verb|IGraphBL| и \verb|IUserBL|. Они содержат ссылки на объекты, 
реализующие интерфейсы \verb|IGraphDao| и \verb|IUserBL|, при 
этом эти объекты передаются в качестве параметров в соответствующие конструкторы. 
При добавлении нового пользователя происходит проверка на существование записи с таким же логином, а кроме этого происходит 
шифровка пароля. 

Также при добавлении нового графа в базу данных в классе, который отвечает за работу с моделью графа, происходит проверка графа 
на 
связность и его размеры. При неудачном прохождении проверки выбрасывается исключение, которое отлавливается на уровне 
представления.

Кроме этого для работы с генетическим алгоритмом создан интерфейс \verb|IAlgorithm|:
\begin{Verbatim}[fontsize=\small, numbers=left]
public interface IAlgorithm
    {
        FindingVertexResponse FindCentralVertex(Graph graph);
        ResearchAlgorithmResponse ResearchAlgorithm(ResearchRequest param);
    }
\end{Verbatim}

Интерфейс определяет набор методов, в которых будет реализована логика для работы с генетическим алгоритмом.
Вместе с тем класс \verb|Algorithm| реализует данный интерфейс и в нем содержится вся логика работы с алгоритмом "--- получение 
результатов поиска центральных вершин, замеры времени работы и процента неверно найденных решений.
 
Результаты измерений возвращаются из методов при помощи классов \verb|FindingVertexResponse| и \verb|ResearchAlgorithmResponse|:
\begin{Verbatim}[fontsize=\small, numbers=left]
public class FindingVertexResponse
{
	public int[] Center { get; set; }
	public int R { get; set; }
	public double Time { get; set; }
}
\end{Verbatim}

\begin{Verbatim}[fontsize=\small, numbers=left]
public class ResearchAlgorithmResponse
    {
        public double AvgTime { get; set; }
        public double Error { get; set; }
    }
\end{Verbatim}


\subsection{Уровень представления}
Так как проект представляет собой веб"=приложение, то уровень, отвечающий за пользовательский интерфейс реализован при помощи 
технологии \verb|ASP .NET MVC 5|. В связи с чем весь код этого уровня разделен на:
\begin{itemize}
    \item контроллеры, которые отвечают на HTTP запросы клиента с помощью представлений,
    \item представления, которые написаны с использованием технологии Razor, позволяющей внедрять серверный C\# код,
		\item модели данных, внутри которых происходит передача данных от клиента серверу и обратно.
\end{itemize}

\subsubsection{Контроллеры}
Для взаимодействия с клиентской частью приложения и обработки пользовательских данных было создано несколько
контроллеров: \verb|HomeController|, \verb|GraphController|, \verb|LoginController|, \verb|ResearchController|.

Класс \verb|HomeController| содержит один метод \verb|Index|, который отвечает на GET"=запрос и возвращает домашнюю страницу.

Класс \verb|GraphController| включает в себя методы, определяющие URL"=адреса при взаимодействии с которыми клиентской части 
приложения предоставляется возможность запускать генетический алгоритм для поиска центральных вершин или добавлять новый граф в 
базу данных. В целом данный контроллер ответственен за обработку следующих запросов:
\begin{itemize}
	\item \verb|/Graph| "--- обрабатывает GET"=запрос возвращает загрузочную страницу для поиска центральных вершин, 
	\item \verb|/Graph/FindCentralVertex| "--- обрабатывает POST"=запрос, в котором передается файл с графом, после чего запускается 
	генетический алгоритм. В качестве результата возвращается страница с сообщением об ошибке, которая могла произойти при 
	обработке запроса из"=за неверного формата данных в файле с графом, или слишком большого размера загружаемого графа, либо же 
	при успешном запуске возвращает страницу с результатами работы "--- радиус графа и возможные центральные вершины, 
	\item \verb|/Graph/Add| "--- обрабатывает GET"=запрос, который возвращает форму для загрузки графа в базу данных,
	\item \verb|/Graph/Add| "--- обрабатывает POST"=запрос, в котором пользователь предает на сервер для сохранения файл с графом и название 
	графа. При успешном добавлении перенаправляет пользователя на домашнюю страницу, при возможной ошибке "--- страницу с 
	описанием ошибки.
\end{itemize}

Класс \verb|ResearchController| содержит методы через которые пользователю предоставляется возможность запускать генетический 
алгоритм с различными параметрами ($p_c, p_m, N$), а также граф на котором будет тестироваться алгоритм.
Контроллер содержит следующие методы:
\begin{itemize}
	\item \verb|/Research/Index| "--- обрабатывает GET"=запрос и возвращает форму с выбором параметров для генетического 
	алгоритма, при этом в результат подгружаются описания графов, сохраненных в базе данных,
	\item \verb|/Research/ResearchAlgorithm| "--- обрабатывает POST"=запрос в который передаются выбранные параметры алгоритма и 
	выбранный граф.
\end{itemize}




\bibliographystyle{gost780uv}
\bibliography{thesis}

% Окончание основного документа и начало приложений
% Каждая последующая секция документа будет являться приложением
\appendix

\section{Нумеруемые объекты в приложении}
HELLO


\end{document}
